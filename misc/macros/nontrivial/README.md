https://adventures.michaelfbryan.com/posts/non-trivial-macros/
